#!/bin/bash
printf "NOTE: Please remember to update the PROJECT_NAMESPACE variable in the script so that it correctly references the namespace where you have"
export PROJECT_NAMESPACE="cp4waiops"

# optional argument handling
if [[ "$1" == "version" ]]
then
    echo "0.0.2"
    exit 0
fi

# optional argument handling
if [[ "$1" == "config" ]]
then
    echo "$KUBECONFIG"
    exit 0
fi

# optional argument handling
if [[ "$1" == "status" ]]
then
    oc get installations.orchestrator.aiops.ibm.com -A && echo "" &&  oc get ircore,AIOpsAnalyticsOrchestrator -A  -o custom-columns="KIND:kind,NAMESPACE:metadata.namespace,NAME:metadata.name,VERSION:status.versions.reconciled,STATUS:status.conditions[?(@.type==\"Ready\")].reason" && echo "" && oc get lifecycleservice -A -o custom-columns="KIND:kind,NAMESPACE:metadata.namespace,NAME:metadata.name,VERSION:status.versions.reconciled,STATUS:status.conditions[?(@.type==\"Lifecycle Service Ready\")].reason" && echo "" && oc get BaseUI -A  -o custom-columns="KIND:kind,NAMESPACE:metadata.namespace,NAME:metadata.name,VERSION:status.versions.reconciled,STATUS:status.conditions[?(@.type==\"Ready\")].reason" && echo "" && oc get AIManager,aiopsedge,asm -A  -o custom-columns="KIND:kind,NAMESPACE:metadata.namespace,NAME:metadata.name,VERSION:status.versions.reconciled,STATUS:status.phase"
    echo "" && oc get automationuiconfig,automationbase,cartridge,cartridgerequirements -A -o custom-columns='KIND:.kind,NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.conditions[?(@.type=="Ready")].status'
    echo "" && oc get zenservice -A -o custom-columns='KIND:.kind,NAME:.metadata.name,NAMESPACE:.metadata.namespace,STATUS:.status.zenStatus,PROGRESS:.status.Progress,MESSAGE:.status.ProgressMessage'
    
    printf "\nCSVs from $PROJECT_NAMESPACE namespace:"
    echo "" && oc get csvs -n $PROJECT_NAMESPACE 
    
    printf "\nCSVs from ibm-common-services namespace:"
    echo "" && oc get csvs -n ibm-common-services

    printf "\nSubscriptions from $PROJECT_NAMESPACE namespace:"
    echo "" && oc get subscriptions -n $PROJECT_NAMESPACE 
    
    printf "\nSubscriptions from ibm-common-services namespace:"
    echo "" && oc get subscriptions -n ibm-common-services
    exit 0
fi

echo "kubectl-waiops"
